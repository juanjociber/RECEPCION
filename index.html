<!-- <!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Selección de Partes del Camión</title>
</head>
<body>
    <canvas id="miCanvas" width="800" height="400" style="border:1px solid #000;"></canvas>
    <div>
        <input type="checkbox" id="cabina" value="cabina">
        <label for="cabina">Cabina</label>
        <input type="checkbox" id="ruedas" value="ruedas">
        <label for="ruedas">Ruedas</label>
        <input type="checkbox" id="caja" value="caja">
        <label for="caja">Caja</label>
    </div>

    <script>
        const canvas = document.getElementById('miCanvas');
        const ctx = canvas.getContext('2d');
        const img = new Image();
        img.src = '/img/activo.png';  // Ruta de la imagen cargada

        // Dibujar la imagen en el canvas
        img.onload = function() {
            ctx.drawImage(img, 0, 0, 800, 400); // Ajusta las dimensiones según sea necesario
        };

        // Coordenadas de las áreas del camión
        const areas = {
            cabina: { x: 50, y: 100, width: 300, height: 200 },
            ruedas: { x: 350, y: 300, width: 300, height: 100 },
            caja: { x: 400, y: 100, width: 400, height: 200 }
        };

        console.log(areas);

        // Detectar clics en el canvas
        canvas.addEventListener('click', function(event) {
            const x = event.offsetX;
            const y = event.offsetY;

            for (const area in areas) {
                const { x: ax, y: ay, width, height } = areas[area];
                if (x > ax && x < ax + width && y > ay && y < ay + height) {
                    document.getElementById(area).checked = !document.getElementById(area).checked;
                }
            }
        });
    </script>
</body>
</html> -->



<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Selección Circular de Partes de Vehículo</title>
    <style>
        #canvas-container {
            width: 600px;
            height: 400px;
            position: relative;
            border: 1px solid #000;
        }
        canvas {
            width: 100%;
            height: 100%;
            cursor: crosshair;
        }
        #controls {
            margin-top: 20px;
        }
        .selected-area {
            display: flex;
            align-items: center;
        }
        .selected-area label {
            margin-left: 10px;
        }
    </style>
</head>
<body>

<input type="file" id="imageLoader" name="imageLoader"/>
<div id="canvas-container">
    <canvas id="miCanvas"></canvas>
</div>
<div id="controls">
    <div id="selectedAreas"></div>
</div>

<script>
    const canvas = document.getElementById('miCanvas');
const ctx = canvas.getContext('2d');
let img = new Image();
let startX, startY;
const circles = [];

// Manejar la carga de imágenes
document.getElementById('imageLoader').addEventListener('change', handleImage, false);

function handleImage(e) {
    const reader = new FileReader();
    reader.onload = function(event) {
        img.onload = function() {
            // Establecer el tamaño del canvas según la imagen
            canvas.width = img.width;
            canvas.height = img.height;
            drawImage();
        };
        img.src = event.target.result;
    };
    reader.readAsDataURL(e.target.files[0]);
}

function drawImage() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

    // Dibujar círculos
    circles.forEach(circle => {
        ctx.beginPath();
        ctx.arc(circle.x, circle.y, circle.radius, 0, 2 * Math.PI);
        ctx.strokeStyle = 'red';
        ctx.stroke();
        ctx.lineWidth = 2;
        ctx.fillStyle = 'rgba(255, 0, 0, 0.3)';
        ctx.fill();
    });
}

// Iniciar la selección circular al hacer clic
canvas.addEventListener('mousedown', function(event) {
    const rect = canvas.getBoundingClientRect();
    const scaleX = canvas.width / rect.width;
    const scaleY = canvas.height / rect.height;

    // Obtener coordenadas precisas
    startX = (event.clientX - rect.left) * scaleX;
    startY = (event.clientY - rect.top) * scaleY;
});

// Completar la selección circular al soltar el clic
canvas.addEventListener('mouseup', function(event) {
    const rect = canvas.getBoundingClientRect();
    const scaleX = canvas.width / rect.width;
    const scaleY = canvas.height / rect.height;

    const endX = (event.clientX - rect.left) * scaleX;
    const endY = (event.clientY - rect.top) * scaleY;

    const radius = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
    
    const areaName = prompt("Ingrese el nombre de la parte seleccionada:");
    if (areaName) {
        circles.push({ x: startX, y: startY, radius: radius, name: areaName });
        drawImage();
        updateSelectedAreas();
    } else {
        alert("Debe ingresar un nombre para la parte seleccionada.");
    }
});

// Actualizar la lista de áreas seleccionadas
function updateSelectedAreas() {
    const areasDiv = document.getElementById('selectedAreas');
    areasDiv.innerHTML = '';
    circles.forEach((circle, index) => {
        const div = document.createElement('div');
        div.className = 'selected-area';

        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.id = `area_${index}`;
        checkbox.value = circle.name;
        checkbox.checked = true;

        const label = document.createElement('label');
        label.htmlFor = `area_${index}`;
        label.textContent = circle.name;

        div.appendChild(checkbox);
        div.appendChild(label);
        areasDiv.appendChild(div);
    });
}

// Ajustar el tamaño del canvas según la selección
function adjustCanvasSize(x, y, radius) {
    // Establecer el tamaño del canvas basado en la selección
    canvas.width = Math.max(x + radius, canvas.width);
    canvas.height = Math.max(y + radius, canvas.height);

    // Ajustar el tamaño del canvas
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    drawImage();
}

</script>

</body>
</html>






