<!-- <!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Selección de Partes del Camión</title>
</head>
<body>
    <canvas id="miCanvas" width="800" height="400" style="border:1px solid #000;"></canvas>
    <div>
        <input type="checkbox" id="cabina" value="cabina">
        <label for="cabina">Cabina</label>
        <input type="checkbox" id="ruedas" value="ruedas">
        <label for="ruedas">Ruedas</label>
        <input type="checkbox" id="caja" value="caja">
        <label for="caja">Caja</label>
    </div>

    <script>
        const canvas = document.getElementById('miCanvas');
        const ctx = canvas.getContext('2d');
        const img = new Image();
        img.src = '/img/activo.png';  // Ruta de la imagen cargada

        // Dibujar la imagen en el canvas
        img.onload = function() {
            ctx.drawImage(img, 0, 0, 800, 400); // Ajusta las dimensiones según sea necesario
        };

        // Coordenadas de las áreas del camión
        const areas = {
            cabina: { x: 50, y: 100, width: 300, height: 200 },
            ruedas: { x: 350, y: 300, width: 300, height: 100 },
            caja: { x: 400, y: 100, width: 400, height: 200 }
        };

        console.log(areas);

        // Detectar clics en el canvas
        canvas.addEventListener('click', function(event) {
            const x = event.offsetX;
            const y = event.offsetY;

            for (const area in areas) {
                const { x: ax, y: ay, width, height } = areas[area];
                if (x > ax && x < ax + width && y > ay && y < ay + height) {
                    document.getElementById(area).checked = !document.getElementById(area).checked;
                }
            }
        });
    </script>
</body>
</html> -->



<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Selección Circular de Partes de Vehículo</title>
    <style>
        #canvas-container {
            width: 600px;
            height: 400px;
            position: relative;
            border: 1px solid #000;
        }
        canvas {
            width: 100%;
            height: 100%;
            cursor: crosshair;
        }
        #controls {
            margin-top: 20px;
        }
        .selected-area {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .selected-area label {
            margin-left: 10px;
        }
        #toolbox {
            margin-bottom: 20px;
        }
        .tool-option {
            margin-right: 10px;
        }
        #namePromptButton {
            margin-top: 20px;
        }
    </style>
</head>
<body>

<div id="toolbox">
    <div class="tool-option">
        <label for="colorPicker">Color:</label>
        <input type="color" id="colorPicker" value="#ff0000"/>
    </div>
    <div class="tool-option">
        <label for="lineWidth">Grosor:</label>
        <input type="number" id="lineWidth" min="1" max="10" value="2"/>
    </div>
    <div class="tool-option">
        <label for="drawArrow">Flecha:</label>
        <input type="checkbox" id="drawArrow"/>
    </div>
</div>

<input type="file" id="imageLoader" name="imageLoader"/>

<div id="canvas-container">
    <canvas id="miCanvas"></canvas>
</div>

<div id="controls">
    <button id="namePromptButton">Asignar Nombre a la Parte Seleccionada</button>
    <div id="selectedAreas"></div>
</div>

<script>
    const canvas = document.getElementById('miCanvas');
    const ctx = canvas.getContext('2d');
    let img = new Image();
    let startX, startY;
    const circles = [];
    let color = '#ff0000';
    let lineWidth = 2;
    let drawArrow = false;
    let currentCircle = null;

    document.getElementById('imageLoader').addEventListener('change', handleImage, false);
    document.getElementById('colorPicker').addEventListener('input', (e) => color = e.target.value);
    document.getElementById('lineWidth').addEventListener('input', (e) => lineWidth = parseInt(e.target.value, 10));
    document.getElementById('drawArrow').addEventListener('change', (e) => drawArrow = e.target.checked);

    function handleImage(e) {
        const reader = new FileReader();
        reader.onload = function(event) {
            img.onload = function() {
                canvas.width = img.width;
                canvas.height = img.height;
                drawImage();
            };
            img.src = event.target.result;
        };
        reader.readAsDataURL(e.target.files[0]);
    }

    function drawImage() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
        circles.forEach(circle => {
            drawCircle(circle);
        });
    }

    function drawCircle(circle) {
        ctx.beginPath();
        ctx.arc(circle.x, circle.y, circle.radius, 0, 2 * Math.PI);
        ctx.strokeStyle = circle.color;
        ctx.lineWidth = circle.lineWidth;
        ctx.stroke();
        ctx.fillStyle = `rgba(${parseInt(circle.color.slice(1, 3), 16)}, ${parseInt(circle.color.slice(3, 5), 16)}, ${parseInt(circle.color.slice(5, 7), 16)}, 0.3)`;
        ctx.fill();

        if (circle.drawArrow) {
            drawArrowHead(circle.x, circle.y, circle.radius);
        }
    }

    function drawArrowHead(x, y, radius) {
        const angle = Math.random() * 2 * Math.PI; // Random angle for the arrow
        const arrowLength = radius / 4;
        const arrowWidth = 10;

        ctx.beginPath();
        ctx.moveTo(x + radius * Math.cos(angle), y + radius * Math.sin(angle));
        ctx.lineTo(x + (radius + arrowLength) * Math.cos(angle - Math.PI / 6), y + (radius + arrowLength) * Math.sin(angle - Math.PI / 6));
        ctx.lineTo(x + (radius + arrowLength) * Math.cos(angle + Math.PI / 6), y + (radius + arrowLength) * Math.sin(angle + Math.PI / 6));
        ctx.lineTo(x + radius * Math.cos(angle), y + radius * Math.sin(angle));
        ctx.fillStyle = color;
        ctx.fill();
    }

    canvas.addEventListener('mousedown', function(event) {
        const rect = canvas.getBoundingClientRect();
        const scaleX = canvas.width / rect.width;
        const scaleY = canvas.height / rect.height;

        startX = (event.clientX - rect.left) * scaleX;
        startY = (event.clientY - rect.top) * scaleY;
    });

    canvas.addEventListener('mouseup', function(event) {
        const rect = canvas.getBoundingClientRect();
        const scaleX = canvas.width / rect.width;
        const scaleY = canvas.height / rect.height;

        const endX = (event.clientX - rect.left) * scaleX;
        const endY = (event.clientY - rect.top) * scaleY;

        const radius = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
        
        currentCircle = {
            x: startX,
            y: startY,
            radius: radius,
            name: '',
            color: color,
            lineWidth: lineWidth,
            drawArrow: drawArrow
        };
        
        drawCircle(currentCircle);
    });

    document.getElementById('namePromptButton').addEventListener('click', function() {
        if (currentCircle) {
            const areaName = prompt("Ingrese el nombre de la parte seleccionada:");
            if (areaName) {
                currentCircle.name = areaName;
                circles.push(currentCircle);
                drawImage();
                updateSelectedAreas();
                currentCircle = null; // Clear the current circle after saving
            } else {
                alert("Debe ingresar un nombre para la parte seleccionada.");
            }
        } else {
            alert("Primero dibuje un círculo.");
        }
    });

    function updateSelectedAreas() {
        const areasDiv = document.getElementById('selectedAreas');
        areasDiv.innerHTML = '';
        circles.forEach((circle, index) => {
            const div = document.createElement('div');
            div.className = 'selected-area';

            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.id = `area_${index}`;
            checkbox.value = circle.name;
            checkbox.checked = true;

            const label = document.createElement('label');
            label.htmlFor = `area_${index}`;
            label.textContent = circle.name;

            div.appendChild(checkbox);
            div.appendChild(label);
            areasDiv.appendChild(div);
        });
    }
</script>

</body>
</html>










